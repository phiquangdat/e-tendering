<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test API</title>
    <script>
        // Функция для отправки POST-запроса для создания пользователя
        async function createUser() {
            const userData = {
                name: document.getElementById('userName').value,
                email: document.getElementById('userEmail').value,
                address: document.getElementById('userAddress').value,
                user_type: document.getElementById('userType').value,
                password: document.getElementById('userPassword').value,
                categories: []  // Здесь нужно добавить ID категорий, если это необходимо
            };

            try {
                const response = await fetch('http://localhost:5500/create_user', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(userData)
                });
                const result = await response.json();
                console.log(result);
                alert('Пользователь создан успешно');
            } catch (error) {
                console.error('Error creating user:', error);
                alert('Ошибка при создании пользователя');
            }
        }

        // Функция для получения всех пользователей
        async function fetchUsers() {
            try {
                const response = await fetch('http://localhost:5500/users');
                const users = await response.json();
                const usersList = document.getElementById('usersList');
                usersList.innerHTML = ''; // Очистить список перед добавлением новых данных

                users.forEach(user => {
                    const listItem = document.createElement('li');
                    listItem.textContent = `${user.name} (${user.email})`;
                    usersList.appendChild(listItem);
                });
            } catch (error) {
                console.error('Error fetching users:', error);
                alert('Ошибка при получении пользователей');
            }
        }

        // Функция для создания категории
        async function createCategory() {
            const categoryData = {
                category_name: document.getElementById('categoryName').value
            };

            try {
                const response = await fetch('http://localhost:5500/create_category', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(categoryData)
                });
                const result = await response.json();
                console.log(result);
                alert('Категория создана успешно');
            } catch (error) {
                console.error('Error creating category:', error);
                alert('Ошибка при создании категории');
            }
        }

        // Функция для получения всех категорий
        async function fetchCategories() {
            try {
                const response = await fetch('http://localhost:5500/categories');
                const categories = await response.json();
                const categoriesList = document.getElementById('categoriesList');
                categoriesList.innerHTML = ''; // Очистить список перед добавлением новых данных

                categories.forEach(category => {
                    const listItem = document.createElement('li');
                    listItem.textContent = category.category_name;
                    categoriesList.appendChild(listItem);
                });
            } catch (error) {
                console.error('Error fetching categories:', error);
                alert('Ошибка при получении категорий');
            }
        }

        // Функция для создания тендера
        async function createTender() {
            const tenderData = {
                tender_name: document.getElementById('tenderName').value,
                staff_id: document.getElementById('staffId').value,
                construction_from: document.getElementById('constructionFrom').value,
                construction_to: document.getElementById('constructionTo').value,
                date_of_tender_notice: document.getElementById('dateOfTenderNotice').value,
                date_of_tender_close: document.getElementById('dateOfTenderClose').value,
                date_of_tender_winner: document.getElementById('dateOfTenderWinner').value,
                bidding_price: document.getElementById('biddingPrice').value,
                tender_status: document.getElementById('tenderStatus').value
            };

            try {
                const response = await fetch('http://localhost:5500/create_tender', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(tenderData)
                });
                const result = await response.json();
                console.log(result);
                alert('Тендер создан успешно');
            } catch (error) {
                console.error('Error creating tender:', error);
                alert('Ошибка при создании тендера');
            }
        }

        // Функция для получения всех тендеров
        async function fetchTenders() {
            try {
                const response = await fetch('http://localhost:5500/tenders');
                const tenders = await response.json();
                const tendersList = document.getElementById('tendersList');
                tendersList.innerHTML = ''; // Очистить список перед добавлением новых данных

                tenders.forEach(tender => {
                    const listItem = document.createElement('li');
                    listItem.textContent = tender.tender_name;
                    tendersList.appendChild(listItem);
                });
            } catch (error) {
                console.error('Error fetching tenders:', error);
                alert('Ошибка при получении тендеров');
            }
        }
    </script>
</head>
<body>

    <h1>API Test</h1>

    <h2>Создать пользователя</h2>
    <label for="userName">Имя:</label><input type="text" id="userName"><br>
    <label for="userEmail">Email:</label><input type="email" id="userEmail"><br>
    <label for="userAddress">Адрес:</label><input type="text" id="userAddress"><br>
    <label for="userType">Тип пользователя:</label><input type="text" id="userType"><br>
    <label for="userPassword">Пароль:</label><input type="password" id="userPassword"><br>
    <button onclick="createUser()">Создать пользователя</button>

    <h2>Список пользователей</h2>
    <button onclick="fetchUsers()">Получить пользователей</button>
    <ul id="usersList"></ul>

    <h2>Создать категорию</h2>
    <label for="categoryName">Название категории:</label><input type="text" id="categoryName"><br>
    <button onclick="createCategory()">Создать категорию</button>

    <h2>Список категорий</h2>
    <button onclick="fetchCategories()">Получить категории</button>
    <ul id="categoriesList"></ul>

    <h2>Создать тендер</h2>
    <label for="tenderName">Название тендера:</label><input type="text" id="tenderName"><br>
    <label for="staffId">ID сотрудника:</label><input type="text" id="staffId"><br>
    <label for="constructionFrom">Дата начала строительства:</label><input type="date" id="constructionFrom"><br>
    <label for="constructionTo">Дата окончания строительства:</label><input type="date" id="constructionTo"><br>
    <label for="dateOfTenderNotice">Дата объявления тендера:</label><input type="date" id="dateOfTenderNotice"><br>
    <label for="dateOfTenderClose">Дата закрытия тендера:</label><input type="date" id="dateOfTenderClose"><br>
    <label for="dateOfTenderWinner">Дата объявления победителя:</label><input type="date" id="dateOfTenderWinner"><br>
    <label for="biddingPrice">Начальная цена:</label><input type="number" id="biddingPrice"><br>
    <label for="tenderStatus">Статус тендера:</label><input type="text" id="tenderStatus"><br>
    <button onclick="createTender()">Создать тендер</button>

    <h2>Список тендеров</h2>
    <button onclick="fetchTenders()">Получить тендеры</button>
    <ul id="tendersList"></ul>

</body>
</html>
